"use strict";(self.webpackChunkahlin=self.webpackChunkahlin||[]).push([[329],{329:(e,l,a)=>{a.r(l),a.d(l,{default:()=>g});var s=a(5043),i=a(6068),o=a(8365),d=a(6178),t=a.n(d),n=a(579);const r=e=>{let{bookings:l}=e;const[a,i]=(0,s.useState)({columns:[{label:"S.No.",field:"sno",width:50,selected:!1},{label:"Booking Id",field:"id",width:50,selected:!1},{label:"Local Name",field:"name",width:50,selected:!1},{label:"Guest Name",field:"gname",width:50,selected:!1},{label:"Mobile No.",field:"mobile",width:100,selected:!1},{label:"Booking Amount",field:"amount",width:50,selected:!1},{label:"Booking Date",field:"date",width:50,selected:!1}],rows:[]});(0,s.useEffect)((()=>{d()}),[l]);const d=()=>{const e=[];null===l||void 0===l||l.map(((l,a)=>{var s,i,o;const d={};d.sno=a+1,d.name=(null===l||void 0===l?void 0:l.packageName)||"NA",d.id=(null===l||void 0===l?void 0:l.bookingId)||"NA",d.name=(null===l||void 0===l||null===(s=l.local)||void 0===s?void 0:s.fullName)||"NA",d.mobile=(null===l||void 0===l||null===(i=l.local)||void 0===i?void 0:i.mobileNumber)||"NA",d.amount=(null===l||void 0===l||null===(o=l.package)||void 0===o?void 0:o.price)||"NA",d.date=t()(null===l||void 0===l?void 0:l.createdAt).format("L")||"NA",e.push(d)})),i({...a,rows:e})};return(0,n.jsx)("div",{className:"col-xl-12 pt-4",children:(0,n.jsx)("div",{className:"card dz-card",id:"bootstrap-table1",children:(0,n.jsxs)("div",{className:"col-12 card-body position-relative card-body-2",children:[(0,n.jsx)("div",{className:"card_title_container",children:(0,n.jsx)("h4",{className:"card-title",children:"Trip Booking History"})}),(0,n.jsx)("div",{className:"search_icon search_icon2",children:(0,n.jsx)("i",{class:"fa-solid fa-magnifying-glass"})}),(0,n.jsx)("div",{className:"table-responsive mdb_table mdb_table_new mdb2",children:(0,n.jsx)(o.g6D,{bordered:!0,displayEntries:!0,entries:10,className:"text-nowrap",hover:!0,data:a,noBottomColumns:!0,sortable:!0,paginationLabel:"\xab\xbb"})}),(0,n.jsx)("div",{className:"table-responsive mdb_table2"})]})})})};var c=a(4858),m=a(3216),u=a(4299),v=a(64),b=a.n(v);const h=e=>{let{title:l}=e;const[a,i]=(0,s.useState)(!1);return(0,n.jsxs)("div",{children:[(0,n.jsx)("i",{onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),class:"fa-solid fa-circle-info me-3"}),a&&(0,n.jsx)("span",{className:"position-absolute info_box",children:l})]})},g=()=>{var e,l,a;const[o,d]=(0,s.useState)(),[v,g]=(0,s.useState)([]),[p,x]=(0,s.useState)({}),[j,N]=(0,s.useState)(),[f,y]=(0,s.useState)(),[w,k]=(0,s.useState)(0),[A,C]=(0,s.useState)([]),{id:M}=(0,m.g)(),{state:B}=(0,m.zy)(),S=(0,m.Zp)(),[_,L]=(0,s.useState)(),[D,I]=(0,s.useState)(""),{register:P,handleSubmit:q,setValue:F,formState:{errors:T}}=(0,c.mN)({mode:"onChange"});(0,s.useEffect)((()=>{"Guide"===(null===B||void 0===B?void 0:B.type)&&Y(),"User"===(null===B||void 0===B?void 0:B.type)&&E()}),[]);const Y=async()=>{try{let{data:s}=await(0,u.Pu)(M);if(s&&(null===s||void 0===s||!s.error)){var e,l,a;d(null===s||void 0===s||null===(e=s.results)||void 0===e?void 0:e.guide);let i=null===s||void 0===s||null===(l=s.results)||void 0===l?void 0:l.guide;console.log(i),g(null===s||void 0===s||null===(a=s.results)||void 0===a?void 0:a.bookings),F("name",(null===i||void 0===i?void 0:i.fullName)||"NA"),F("number",(null===i||void 0===i?void 0:i.mobileNumber)||"NA"),F("email",(null===i||void 0===i?void 0:i.email)||"NA"),F("dob",t()(null===i||void 0===i?void 0:i.dob).format("YYYY-MM-DD")||"NA"),F("image",(null===i||void 0===i?void 0:i.profile_image)||"NA"),F("country",(null===i||void 0===i?void 0:i.countryName)||"NA"),k(null===i||void 0===i?void 0:i.commission),N(null===i||void 0===i?void 0:i.profileImage[0])}}catch(s){console.log(s)}},E=async()=>{try{let{data:s}=await(0,u.ID)(M);if(s&&(null===s||void 0===s||!s.error)){var e,l,a;console.log(s),d(null===s||void 0===s||null===(e=s.results)||void 0===e?void 0:e.user);let i=null===s||void 0===s||null===(l=s.results)||void 0===l?void 0:l.user;g(null===s||void 0===s||null===(a=s.results)||void 0===a?void 0:a.bookings),F("name","".concat(null===i||void 0===i?void 0:i.fullName)||"NA"),F("email",(null===i||void 0===i?void 0:i.email)||"NA"),F("number",(null===i||void 0===i?void 0:i.mobileNumber)||"NA"),F("dob",t()(null===i||void 0===i?void 0:i.dob).format("YYYY-MM-DD")||"NA"),F("image",(null===i||void 0===i?void 0:i.profile_image)||"NA"),N(null===i||void 0===i?void 0:i.profileImage[0]),F("country",(null===i||void 0===i?void 0:i.countryName)||"NA")}}catch(s){console.log(s)}},G=async(e,l)=>{if(e.preventDefault(),!1===l&&""===D)return void b().fire({toast:!0,icon:"error",position:"top-end",title:"Please enter the reason",showConfirmButton:!1,timerProgressBar:!0,timer:3e3});let a={approve:l,...!1===l&&{rejectionReason:D}};console.log(a);try{let{data:e}=await(0,u.B2)(M,a);!e||null!==e&&void 0!==e&&e.error||(b().fire({toast:!0,icon:"success",position:"top-end",title:"Certificate ".concat(!0===l?"approved":"rejected"," successfully"),showConfirmButton:!1,timerProgressBar:!0,timer:3e3}),document.getElementById("closeCertificateModal").click(),document.getElementById("closeRejectModal").click(),S(-1))}catch(s){console.log(s)}};return(0,n.jsx)(i.A,{activeSlide:"Guest",children:(0,n.jsx)("div",{className:"content-body",children:(0,n.jsx)("div",{className:"container-fluid",children:(0,n.jsxs)("div",{className:"row",children:[(0,n.jsx)("div",{className:"col-xl-12",children:(0,n.jsxs)("div",{className:"card profile-card card-bx m-b30",children:[(0,n.jsx)("div",{className:"card-header",children:(0,n.jsx)("h6",{className:"title",children:null===B||void 0===B?void 0:B.title})}),(0,n.jsxs)("form",{className:"profile-form",children:[(0,n.jsx)("div",{className:"card-body",children:(0,n.jsxs)("div",{className:"row",children:[(0,n.jsxs)("div",{className:"col-md-3 m-b30",children:[(0,n.jsxs)("label",{className:"form-label",children:["Name",(0,n.jsx)("sup",{className:"mandatesign",children:"*"})]}),(0,n.jsx)("input",{disabled:!0,type:"text",name:"name",className:"form-control ".concat(T.name?"is-invalid":""),...P("name",{required:"* Name is required",minLength:{value:2,message:"Minimum 2 characters"},pattern:{value:/^(?!\s)[^\d]*(?:\s[^\d]+)*$/,message:"Spaces at the start & numbers are not allowed"}})}),T.name&&(0,n.jsx)("div",{className:"invalid-feedback",children:T.name.message})]}),(0,n.jsxs)("div",{className:"col-md-3 m-b30",children:[(0,n.jsxs)("label",{className:"form-label",children:["Contact Number",(0,n.jsx)("sup",{className:"mandatesign",children:"*"})]}),(0,n.jsx)("input",{disabled:!0,type:"number",className:"form-control ".concat(T.number?"is-invalid":""),...P("number",{required:"* Number is required",minLength:{value:9,message:"Minimum 9 digits"}})}),T.number&&(0,n.jsx)("div",{className:"invalid-feedback",children:T.number.message})]}),(0,n.jsxs)("div",{className:"col-md-3 m-b30",children:[(0,n.jsxs)("label",{className:"form-label",children:["Email Id",(0,n.jsx)("sup",{className:"mandatesign",children:"*"})]}),(0,n.jsx)("input",{disabled:!0,type:"email",className:"form-control ".concat(T.email?"is-invalid":""),...P("email",{required:"* Email is required",pattern:{value:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,message:"Invalid email address"}})}),T.email&&(0,n.jsx)("div",{className:"invalid-feedback",children:T.email.message})]}),(0,n.jsxs)("div",{className:"col-md-3 m-b30",children:[(0,n.jsxs)("label",{className:"form-label",children:["Date of birth",(0,n.jsx)("sup",{className:"mandatesign",children:"*"})]}),(0,n.jsx)("input",{disabled:!0,type:"date",className:"form-control ".concat(T.dob?"is-invalid":""),...P("dob",{required:"* Dob is required"})}),T.dob&&(0,n.jsx)("div",{className:"invalid-feedback",children:T.dob.message})]}),(0,n.jsxs)("div",{className:"col-md-3 m-b30",children:[(0,n.jsxs)("label",{className:"form-label",children:["Country",(0,n.jsx)("sup",{className:"mandatesign",children:"*"})]}),(0,n.jsx)("input",{disabled:!0,type:"text",className:"form-control ".concat(T.country?"is-invalid":""),...P("country",{required:"* Country is required"})}),T.country&&(0,n.jsx)("div",{className:"invalid-feedback",children:T.country.message})]}),"Guide"===(null===B||void 0===B?void 0:B.type)&&(0,n.jsxs)("div",{className:"col-md-3 m-b30",children:[(0,n.jsxs)("label",{className:"form-label d-flex position-relative",children:["Ahlain Fee",(0,n.jsx)("sup",{className:"mandatesign",children:"*"})," ",(0,n.jsx)(h,{title:"Ahlain Fee percentage: Indicates the percentage of the trip cost that goes to Ahlain."})]}),(0,n.jsx)("input",{type:"number",value:w,className:"form-control",onChange:e=>k(e.target.value)})]}),(0,n.jsxs)("div",{className:"col-md-3 m-b30",children:[(0,n.jsxs)("label",{className:"form-label",children:["Joined on",(0,n.jsx)("sup",{className:"mandatesign",children:"*"})]}),(0,n.jsx)("input",{type:"text",value:t()(null===o||void 0===o?void 0:o.createdAt).format("L"),className:"form-control"})]}),"Guide"===(null===B||void 0===B?void 0:B.type)&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"col-md-3 m-b30 position-relative",children:[(0,n.jsxs)("label",{className:"form-label",children:["View Certificate & Approve",(0,n.jsx)("sup",{className:"mandatesign",children:"*"})]}),(0,n.jsx)("button",{className:"btn btn-primary d-flex justify-content-center w-100",type:"button",onClick:()=>y(null===o||void 0===o?void 0:o.certificate),"data-bs-toggle":"modal","data-bs-target":"#exampleModalToggle",children:(0,n.jsx)("span",{className:"me-3 text-center",children:"View Certificate"})})]})}),"Guide"!==(null===B||void 0===B?void 0:B.type)&&(0,n.jsx)("div",{className:"col-md-5 m-b30",children:(0,n.jsxs)("label",{className:"form-label",htmlFor:"img",children:["Passport Image",(0,n.jsx)("sup",{className:"mandatesign",children:"*"}),(0,n.jsxs)("div",{className:"mt-2",children:[(0,n.jsx)("img",{src:j||"/images/0_91v0rV9LQBJdPX7s.jpg",className:"passport_photo_manage",alt:"i"}),(0,n.jsx)("input",{type:"file",onChange:e=>{C(e.target.files[0])},className:"d-none",name:"img",id:"img"})]})]})}),"Guide"===(null===B||void 0===B?void 0:B.type)&&(null===o||void 0===o||null===(e=o.tripMemories)||void 0===e?void 0:e.length)>0&&(0,n.jsxs)("div",{className:"row",children:[(0,n.jsxs)("label",{className:"form-label",children:["Gallery",(0,n.jsx)("sup",{className:"mandatesign"})]}),(null===o||void 0===o?void 0:o.tripMemories)&&(null===o||void 0===o||null===(l=o.tripMemories)||void 0===l?void 0:l.length)>0&&(null===o||void 0===o||null===(a=o.tripMemories)||void 0===a?void 0:a.map(((e,l)=>void 0!==e&&(0,n.jsx)("div",{className:"col-6 col-sm-4 col-md-3 col-lg-2 p-1 position-relative",children:void 0!==e&&(0,n.jsxs)(n.Fragment,{children:[/\.(mp4|webm|ogg)$/i.test(e)?(0,n.jsxs)("video",{className:"w-100 rounded border border-light object-fit p-1 bg-light",height:220,"data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:()=>L({type:"video",link:e}),children:[(0,n.jsx)("source",{src:e,type:"video/mp4"}),"Your browser does not support the video tag."]}):(0,n.jsx)("img",{src:e,alt:"",className:"w-100 rounded border border-light object-fit p-1 bg-light",height:220,onClick:()=>L({type:"image",link:e}),"data-bs-toggle":"modal","data-bs-target":"#exampleModal"}),(0,n.jsx)("i",{className:"fa-solid fa-trash-can delete_image",onClick:()=>(async e=>{try{let{data:l}=await(0,u.Dz)(M,{url:e});!l||null!==l&&void 0!==l&&l.error||b().fire({toast:!0,icon:"success",position:"top-end",title:"Resource deleted successfully",showConfirmButton:!1,timerProgressBar:!0,timer:3e3}),E()}catch(l){console.log(l)}})(e)})]})},l))))]})]})}),"Guide"===(null===B||void 0===B?void 0:B.type)&&(0,n.jsx)("div",{className:"card-footer justify-content-start",children:(0,n.jsxs)("button",{className:"btn btn-primary d-flex align-items-center",onClick:async e=>{e.preventDefault();try{if(w>100||!w||w<1)return b().fire({toast:!0,icon:"warning",position:"top-end",title:"Please enter a valid Ahlain Fee percentage",showConfirmButton:!1,timerProgressBar:!0,timer:3e3}),!1;let e={guideId:M,commission:w},{data:l}=await(0,u._s)(e);!l||null!==l&&void 0!==l&&l.error||b().fire({toast:!0,icon:"success",position:"top-end",title:"Ahlain Fee updated successfully",showConfirmButton:!1,timerProgressBar:!0,timer:3e3}),S(-1)}catch(l){console.log(l)}},type:"button",children:[(0,n.jsx)("span",{className:"me-3",children:"Update Ahlain Fee"})," ",(0,n.jsx)(h,{title:"Only Ahlain Fee will be updated"})]})}),(null===B||void 0===B?void 0:B.isEdit)&&(0,n.jsx)("div",{className:"card-footer justify-content-start ",children:(0,n.jsx)("button",{className:"btn btn-primary",children:"Save"})})]})]})}),(0,n.jsx)("div",{class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:(0,n.jsx)("div",{class:"modal-dialog modal-dialog-center",children:(0,n.jsx)("div",{class:"modal-content",children:(0,n.jsxs)("div",{class:"modal-body position-relative",children:[(0,n.jsx)("div",{className:"position-absolute top-0 end-0 gallery-close",children:(0,n.jsx)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})}),"video"===(null===_||void 0===_?void 0:_.type)&&(0,n.jsxs)("video",{className:"w-100 rounded border border-light object-fit p-1 bg-light",height:300,"data-bs-toggle":"modal","data-bs-target":"#exampleModal",controls:!0,autoPlay:!0,children:[(0,n.jsx)("source",{src:null===_||void 0===_?void 0:_.link,type:"video/mp4"}),"Your browser does not support the video tag."]}),"image"===(null===_||void 0===_?void 0:_.type)&&(0,n.jsx)("img",{src:null===_||void 0===_?void 0:_.link,className:"w-100 object-fit-fill",height:300,alt:""})]})})})}),(0,n.jsx)("div",{class:"modal fade",id:"exampleModalToggle","aria-hidden":"true","aria-labelledby":"exampleModalToggleLabel",tabindex:"-1",children:(0,n.jsx)("div",{class:"modal-dialog modal-dialog-centered",children:(0,n.jsxs)("div",{class:"modal-content",children:[(0,n.jsxs)("div",{class:"modal-header",children:[(0,n.jsx)("h5",{class:"modal-title",id:"exampleModalToggleLabel",children:"View Certificate"}),(0,n.jsx)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"closeCertificateModal"})]}),(0,n.jsx)("div",{class:"modal-body",children:(0,n.jsx)("div",{style:{width:"100%",height:"300px"},children:(0,n.jsx)("img",{className:"w-100 h-100 object-fit-cover",src:f,alt:"certificate"})})}),(0,n.jsxs)("div",{class:"modal-footer",children:[!(null!==o&&void 0!==o&&o.isLicence)&&(0,n.jsx)("button",{type:"submit",onClick:e=>G(e,!0),className:"btn btn-primary",children:"Approve"}),!(null!==o&&void 0!==o&&o.isLicence)&&(0,n.jsx)("button",{type:"button",className:"btn bg-danger text-white","data-bs-target":"#exampleModalToggle2","data-bs-toggle":"modal","data-bs-dismiss":"modal",children:"Reject"})]})]})})}),(0,n.jsx)("div",{class:"modal fade",id:"exampleModalToggle2","aria-hidden":"true","aria-labelledby":"exampleModalToggleLabel2",tabindex:"-1",children:(0,n.jsx)("div",{class:"modal-dialog modal-dialog-centered",children:(0,n.jsxs)("div",{class:"modal-content",children:[(0,n.jsxs)("div",{class:"modal-header",children:[(0,n.jsx)("h5",{class:"modal-title",id:"exampleModalToggleLabel2",children:"Reject Certificate"}),(0,n.jsx)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"closeRejectModal"})]}),(0,n.jsx)("div",{class:"modal-body",children:(0,n.jsxs)("div",{className:"col-12",children:[(0,n.jsx)("label",{htmlFor:"",children:"Please enter the reason"}),(0,n.jsx)("input",{type:"text",className:"w-100 form-control",placeholder:"Reject Reason...",value:D,onChange:e=>I(e.target.value)})]})}),(0,n.jsxs)("div",{class:"modal-footer",children:[(0,n.jsx)("button",{class:"btn btn-primary","data-bs-target":"#exampleModalToggle","data-bs-toggle":"modal","data-bs-dismiss":"modal",children:"Back to Approve"}),(0,n.jsx)("button",{className:"btn bg-danger text-white",type:"button",onClick:e=>G(e,!1),children:"Reject"}),(0,n.jsx)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",children:"Close"})]})]})})}),(0,n.jsx)("div",{children:(0,n.jsx)(r,{bookings:v})})]})})})})}}}]);
//# sourceMappingURL=329.d4426e6f.chunk.js.map