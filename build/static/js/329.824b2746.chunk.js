"use strict";(self.webpackChunkahlin=self.webpackChunkahlin||[]).push([[329],{329:(e,l,s)=>{s.r(l),s.d(l,{default:()=>N});var i=s(5043),a=s(6068),d=s(8365),o=s(6178),n=s.n(o),t=s(579);const r=e=>{let{bookings:l}=e;const[s,a]=(0,i.useState)({columns:[{label:"S.No.",field:"sno",width:50,selected:!1},{label:"Booking Id",field:"id",width:50,selected:!1},{label:"Local Name",field:"name",width:50,selected:!1},{label:"Guest Name",field:"gname",width:50,selected:!1},{label:"Mobile No.",field:"mobile",width:100,selected:!1},{label:"Booking Amount",field:"amount",width:50,selected:!1},{label:"Booking Date",field:"date",width:50,selected:!1}],rows:[]});(0,i.useEffect)((()=>{o()}),[l]);const o=()=>{const e=[];null===l||void 0===l||l.map(((l,s)=>{var i,a,d;const o={};o.sno=s+1,o.name=(null===l||void 0===l?void 0:l.packageName)||"NA",o.id=(null===l||void 0===l?void 0:l.bookingId)||"NA",o.name=(null===l||void 0===l||null===(i=l.local)||void 0===i?void 0:i.fullName)||"NA",o.mobile=(null===l||void 0===l||null===(a=l.local)||void 0===a?void 0:a.mobileNumber)||"NA",o.amount=(null===l||void 0===l||null===(d=l.package)||void 0===d?void 0:d.price)||"NA",o.date=n()(null===l||void 0===l?void 0:l.createdAt).format("L")||"NA",e.push(o)})),a({...s,rows:e})};return(0,t.jsx)("div",{className:"col-xl-12 pt-4",children:(0,t.jsx)("div",{className:"card dz-card",id:"bootstrap-table1",children:(0,t.jsxs)("div",{className:"col-12 card-body position-relative card-body-2",children:[(0,t.jsx)("div",{className:"card_title_container",children:(0,t.jsx)("h4",{className:"card-title",children:"Trip Booking History"})}),(0,t.jsx)("div",{className:"search_icon",children:(0,t.jsx)("i",{class:"fa-solid fa-magnifying-glass"})}),(0,t.jsx)("div",{className:"table-responsive mdb_table",children:(0,t.jsx)(d.g6D,{bordered:!0,displayEntries:!1,entries:10,className:"text-nowrap",hover:!0,data:s,noBottomColumns:!0,sortable:!0,paginationLabel:"\xab\xbb"})}),(0,t.jsx)("div",{className:"table-responsive mdb_table"})]})})})};var c=s(4858),m=s(3216),u=s(4299),v=s(64),b=s.n(v);const h=e=>{let{title:l}=e;const[s,a]=(0,i.useState)(!1);return(0,t.jsxs)("div",{children:[(0,t.jsx)("i",{onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),class:"fa-solid fa-circle-info me-3"}),s&&(0,t.jsx)("span",{className:"position-absolute info_box",children:l})]})},N=()=>{var e,l,s;const[d,o]=(0,i.useState)(),[v,N]=(0,i.useState)([]),[x,p]=(0,i.useState)(""),[g,j]=(0,i.useState)(),[f,y]=(0,i.useState)(0),[A,w]=(0,i.useState)([]),{id:k}=(0,m.g)(),{state:C}=(0,m.zy)(),M=(0,m.Zp)(),{register:S,handleSubmit:_,setValue:D,formState:{errors:I}}=(0,c.mN)({mode:"onChange"});(0,i.useEffect)((()=>{"Guide"===(null===C||void 0===C?void 0:C.type)&&q(),"User"===(null===C||void 0===C?void 0:C.type)&&B()}),[]);const q=async()=>{try{let{data:i}=await(0,u.Pu)(k);if(i&&(null===i||void 0===i||!i.error)){var e,l,s;o(null===i||void 0===i||null===(e=i.results)||void 0===e?void 0:e.guide);let a=null===i||void 0===i||null===(l=i.results)||void 0===l?void 0:l.guide;console.log(a),N(null===i||void 0===i||null===(s=i.results)||void 0===s?void 0:s.bookings),D("name",(null===a||void 0===a?void 0:a.fullName)||"NA"),D("number",(null===a||void 0===a?void 0:a.mobileNumber)||"NA"),D("email",(null===a||void 0===a?void 0:a.email)||"NA"),D("dob",n()(null===a||void 0===a?void 0:a.dob).format("YYYY-MM-DD")||"NA"),D("image",(null===a||void 0===a?void 0:a.profile_image)||"NA"),D("country",(null===a||void 0===a?void 0:a.countryName)||"NA"),y(null===a||void 0===a?void 0:a.commission),j(null===a||void 0===a?void 0:a.profileImage[0])}}catch(i){console.log(i)}},B=async()=>{try{let{data:i}=await(0,u.ID)(k);if(i&&(null===i||void 0===i||!i.error)){var e,l,s;console.log(i),o(null===i||void 0===i||null===(e=i.results)||void 0===e?void 0:e.user);let a=null===i||void 0===i||null===(l=i.results)||void 0===l?void 0:l.user;N(null===i||void 0===i||null===(s=i.results)||void 0===s?void 0:s.bookings),D("name","".concat(null===a||void 0===a?void 0:a.fullName)||"NA"),D("email",(null===a||void 0===a?void 0:a.email)||"NA"),D("number",(null===a||void 0===a?void 0:a.mobileNumber)||"NA"),D("dob",n()(null===a||void 0===a?void 0:a.dob).format("YYYY-MM-DD")||"NA"),D("image",(null===a||void 0===a?void 0:a.profile_image)||"NA"),j(null===a||void 0===a?void 0:a.profileImage[0]),D("country",(null===a||void 0===a?void 0:a.countryName)||"NA")}}catch(i){console.log(i)}};return(0,t.jsx)(a.A,{activeSlide:"Guest",children:(0,t.jsx)("div",{className:"content-body",children:(0,t.jsx)("div",{className:"container-fluid",children:(0,t.jsxs)("div",{className:"row",children:[(0,t.jsx)("div",{className:"col-xl-12",children:(0,t.jsxs)("div",{className:"card profile-card card-bx m-b30",children:[(0,t.jsx)("div",{className:"card-header",children:(0,t.jsx)("h6",{className:"title",children:null===C||void 0===C?void 0:C.title})}),(0,t.jsxs)("form",{className:"profile-form",children:[(0,t.jsx)("div",{className:"card-body",children:(0,t.jsxs)("div",{className:"row",children:[(0,t.jsxs)("div",{className:"col-md-3 m-b30",children:[(0,t.jsxs)("label",{className:"form-label",children:["Name",(0,t.jsx)("sup",{className:"mandatesign",children:"*"})]}),(0,t.jsx)("input",{disabled:!0,type:"text",name:"name",className:"form-control ".concat(I.name?"is-invalid":""),...S("name",{required:"* Name is required",minLength:{value:2,message:"Minimum 2 characters"},pattern:{value:/^(?!\s)[^\d]*(?:\s[^\d]+)*$/,message:"Spaces at the start & numbers are not allowed"}})}),I.name&&(0,t.jsx)("div",{className:"invalid-feedback",children:I.name.message})]}),(0,t.jsxs)("div",{className:"col-md-3 m-b30",children:[(0,t.jsxs)("label",{className:"form-label",children:["Contact Number",(0,t.jsx)("sup",{className:"mandatesign",children:"*"})]}),(0,t.jsx)("input",{disabled:!0,type:"number",className:"form-control ".concat(I.number?"is-invalid":""),...S("number",{required:"* Number is required",minLength:{value:9,message:"Minimum 9 digits"}})}),I.number&&(0,t.jsx)("div",{className:"invalid-feedback",children:I.number.message})]}),(0,t.jsxs)("div",{className:"col-md-3 m-b30",children:[(0,t.jsxs)("label",{className:"form-label",children:["EMAIL ID",(0,t.jsx)("sup",{className:"mandatesign",children:"*"})]}),(0,t.jsx)("input",{disabled:!0,type:"email",className:"form-control ".concat(I.email?"is-invalid":""),...S("email",{required:"* Email is required",pattern:{value:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,message:"Invalid email address"}})}),I.email&&(0,t.jsx)("div",{className:"invalid-feedback",children:I.email.message})]}),(0,t.jsxs)("div",{className:"col-md-3 m-b30",children:[(0,t.jsxs)("label",{className:"form-label",children:["Date of birth",(0,t.jsx)("sup",{className:"mandatesign",children:"*"})]}),(0,t.jsx)("input",{disabled:!0,type:"date",className:"form-control ".concat(I.dob?"is-invalid":""),...S("dob",{required:"* Dob is required"})}),I.dob&&(0,t.jsx)("div",{className:"invalid-feedback",children:I.dob.message})]}),(0,t.jsxs)("div",{className:"col-md-3 m-b30",children:[(0,t.jsxs)("label",{className:"form-label",children:["Country",(0,t.jsx)("sup",{className:"mandatesign",children:"*"})]}),(0,t.jsx)("input",{disabled:!0,type:"text",className:"form-control ".concat(I.country?"is-invalid":""),...S("country",{required:"* Country is required"})}),I.country&&(0,t.jsx)("div",{className:"invalid-feedback",children:I.country.message})]}),"Guide"===(null===C||void 0===C?void 0:C.type)&&(0,t.jsxs)("div",{className:"col-md-3 m-b30",children:[(0,t.jsxs)("label",{className:"form-label d-flex position-relative",children:["Commission",(0,t.jsx)("sup",{className:"mandatesign",children:"*"})," ",(0,t.jsx)(h,{title:"Commission percentage: Indicates the percentage of the trip cost that goes to Ahlain."})]}),(0,t.jsx)("input",{type:"number",value:f,className:"form-control",onChange:e=>y(e.target.value)})]}),(0,t.jsxs)("div",{className:"col-md-3 m-b30",children:[(0,t.jsxs)("label",{className:"form-label",children:["Joined",(0,t.jsx)("sup",{className:"mandatesign",children:"*"})]}),(0,t.jsx)("input",{type:"text",value:n()(null===d||void 0===d?void 0:d.createdAt).format("L"),className:"form-control"})]}),"Guide"!==(null===C||void 0===C?void 0:C.type)&&(0,t.jsx)("div",{className:"col-md-5 m-b30",children:(0,t.jsxs)("label",{className:"form-label",htmlFor:"img",children:["Passport Image",(0,t.jsx)("sup",{className:"mandatesign",children:"*"}),(0,t.jsxs)("div",{className:"mt-2",children:[(0,t.jsx)("img",{src:g||"/images/0_91v0rV9LQBJdPX7s.jpg",className:"passport_photo_manage",alt:"i"}),(0,t.jsx)("input",{type:"file",onChange:e=>{w(e.target.files[0])},className:"d-none",name:"img",id:"img"})]})]})}),"Guide"===(null===C||void 0===C?void 0:C.type)&&(null===d||void 0===d||null===(e=d.tripMemories)||void 0===e?void 0:e.length)>0&&(0,t.jsxs)("div",{className:"row",children:[(0,t.jsxs)("label",{className:"form-label",children:["Gallery",(0,t.jsx)("sup",{className:"mandatesign"})]}),(null===d||void 0===d?void 0:d.tripMemories)&&(null===d||void 0===d||null===(l=d.tripMemories)||void 0===l?void 0:l.length)>0&&(null===d||void 0===d||null===(s=d.tripMemories)||void 0===s?void 0:s.map(((e,l)=>(0,t.jsxs)("div",{className:"col-6 col-sm-4 col-md-3 col-lg-2 p-1 position-relative",children:[(0,t.jsx)("img",{src:e,alt:"",className:"w-100 rounded border border-light object-fit p-1 bg-light",height:220,onClick:()=>p(e),"data-bs-toggle":"modal","data-bs-target":"#exampleModal"}),(0,t.jsx)("i",{class:"fa-solid fa-trash-can delete_image",onClick:()=>(async e=>{alert(e)})(e)})]},l))))]})]})}),"Guide"===(null===C||void 0===C?void 0:C.type)&&(0,t.jsx)("div",{className:"card-footer justify-content-start",children:(0,t.jsxs)("button",{className:"btn btn-primary d-flex align-items-center",onClick:async e=>{e.preventDefault();try{if(f>100||!f||f<1)return b().fire({toast:!0,icon:"warning",position:"top-end",title:"Please enter a valid commission percentage",showConfirmButton:!1,timerProgressBar:!0,timer:3e3}),!1;let e={guideId:k,commission:f},{data:l}=await(0,u._s)(e);!l||null!==l&&void 0!==l&&l.error||b().fire({toast:!0,icon:"success",position:"top-end",title:"Commission updated successfully",showConfirmButton:!1,timerProgressBar:!0,timer:3e3}),M(-1)}catch(l){console.log(l)}},type:"button",children:[(0,t.jsx)("span",{className:"me-3",children:"Update Commission"})," ",(0,t.jsx)(h,{title:"Only commission will be updated"})]})}),(null===C||void 0===C?void 0:C.isEdit)&&(0,t.jsx)("div",{className:"card-footer justify-content-start ",children:(0,t.jsx)("button",{className:"btn btn-primary",children:"Save"})})]})]})}),(0,t.jsx)("div",{class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:(0,t.jsx)("div",{class:"modal-dialog modal-dialog-center",children:(0,t.jsx)("div",{class:"modal-content",children:(0,t.jsxs)("div",{class:"modal-body position-relative",children:[(0,t.jsx)("div",{className:"position-absolute top-0 end-0 gallery-close",children:(0,t.jsx)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})}),(0,t.jsx)("img",{src:x,className:"w-100 object-fit-fill",height:600,alt:""})]})})})}),(0,t.jsx)("div",{children:(0,t.jsx)(r,{bookings:v})})]})})})})}}}]);
//# sourceMappingURL=329.824b2746.chunk.js.map